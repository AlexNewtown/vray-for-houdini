:: V-Ray For Houdini Windows Launcher
::

@echo off

:: Houdini Version
set HOUDINI_VER_MAJOR=@HOUDINI_VERSION@
set HOUDINI_VER_FULL=%HOUDINI_VER_MAJOR%.@HOUDINI_VERSION_BUILD@

:: Houdini User Home
if NOT DEFINED HOME set HOME=%USERPROFILE%\Documents

set HOUDINI_USER_DIR=%HOME%\houdini%HOUDINI_VER_MAJOR%

:: Use OpenVDB < 3
::
set HOUDINI13_VOLUME_COMPATIBILITY=1

:: DO NOT EDIT STUFF BELOW (well, only if you really know what you're doing)
::
set LAUNCHER_LOCATION=%~dp0
set HFS=C:\Program Files\Side Effects Software\Houdini %HOUDINI_VER_FULL%

:: V-Ray Application SDK variables
set VRAY_SDK=%LAUNCHER_LOCATION%\appsdk
set VRAY_PATH=%VRAY_SDK%\bin

:: Set VFB on top
set VRAY_VFB_ALWAYS_ON_TOP=1

:: V-Ray JSON plugin descriptions
set VRAY_PLUGIN_DESC_PATH=%LAUNCHER_LOCATION%\plugins_desc

# V-Ray UI dialog scripts
set VRAY_UI_DS_PATH=%LAUNCHER_LOCATION%\ui

:: Phoenix Loaders
set VRAY_FOR_HOUDINI_AURA_LOADERS=%VRAY_SDK%\bin\plugins

:: Report loading errors
set HOUDINI_DSO_ERROR=1

:: Install Files
xcopy /s /y "%LAUNCHER_LOCATION%\dso\vray_for_houdini.dll" "%HOUDINI_USER_DIR%\dso\"
xcopy /s /y "%LAUNCHER_LOCATION%\deploy\ROP_vray.svg" "%HOUDINI_USER_DIR%\config\Icons\"
xcopy /s /y "%LAUNCHER_LOCATION%\deploy\vfh*.shelf" "%HOUDINI_USER_DIR%\toolbar\"
xcopy /s /y "%LAUNCHER_LOCATION%\deploy\scripts\*" "%HOUDINI_USER_DIR%\scripts\"
xcopy /s /y "%LAUNCHER_LOCATION%\deploy\presets\*" "%HOUDINI_USER_DIR%\presets\"
xcopy /s /y "%LAUNCHER_LOCATION%\deploy\lib\*" "%HOUDINI_USER_DIR%\vfh\lib\"

:: Add libs to path
set PATH=%HFS%\bin;%VRAY_PATH%;%PATH%;%HOUDINI_USER_DIR%\vfh\lib

:: Start Houdini
start "V-Ray For Houdini" /D "%USERPROFILE%\Desktop\" "%HFS%\bin\houdini.exe" -foreground %*
